---
interface Props {
  title: string;
  subtitle?: string;
  badge?: string;
  badgeTone?: 'default' | 'accent' | 'warning';
  priceLabel: string;
  statusLabel?: string;
  statusTone?: 'in-stock' | 'made-to-order' | 'coming-soon';
  href: string;
  imageSrc?: string;
  imageAlt?: string;
}

const {
  title,
  subtitle,
  badge,
  badgeTone = 'default',
  priceLabel,
  statusLabel,
  statusTone = 'in-stock',
  href,
  imageSrc = '/images/placeholders/service-dark.svg',
  imageAlt = title
} = Astro.props;

const badgeClassMap: Record<string, string> = {
  default: 'bg-white/6 text-slate-100',
  accent: 'bg-roiBlue/15 text-roiBlue',
  warning: 'bg-amber-500/15 text-amber-300',
};

const statusClassMap: Record<string, string> = {
  'in-stock': 'text-emerald-400 bg-emerald-500/10 ring-emerald-500/30',
  'made-to-order': 'text-sky-300 bg-sky-500/10 ring-sky-500/25',
  'coming-soon': 'text-slate-300/90 bg-slate-500/10 ring-slate-500/25',
};

const badgeClasses = badge ? badgeClassMap[badgeTone] ?? badgeClassMap.default : '';
const statusClasses = statusLabel ? statusClassMap[statusTone] ?? statusClassMap['made-to-order'] : '';
---

<article
  class="group flex flex-col overflow-hidden rounded-2xl border border-white/7 bg-slate-950/35 shadow-[0_22px_60px_rgba(0,0,0,0.7)] backdrop-blur-sm transition-transform transition-shadow duration-300 hover:-translate-y-1 hover:shadow-[0_28px_80px_rgba(0,0,0,0.9)]"
>
  <!-- Clickable image area -->
  <a href={href} class="relative block overflow-hidden">
    <div class="aspect-[4/3] w-full bg-gradient-to-br from-slate-900/80 via-slate-900/60 to-slate-950">
      <img
        src={imageSrc}
        alt={imageAlt}
        loading="lazy"
        decoding="async"
        class="h-full w-full object-cover object-center opacity-95 transition duration-300 group-hover:scale-[1.03] group-hover:opacity-100"
      />

      <!-- Subtle top gradient overlay -->
      <div class="pointer-events-none absolute inset-0 bg-gradient-to-b from-black/30 via-transparent to-black/40"></div>

      <!-- Badge in the image corner -->
      {badge && (
        <div class="pointer-events-none absolute left-3 top-3 sm:left-4 sm:top-4">
          <span
            class={`inline-flex items-center rounded-full px-2.5 py-1 text-[0.68rem] font-medium uppercase tracking-[0.16em] ring-1 ring-white/8 ${badgeClasses}`}
          >
            {badge}
          </span>
        </div>
      )}
    </div>
  </a>

  <!-- Card body -->
  <div class="flex flex-1 flex-col px-4 pb-4 pt-4 sm:px-5 sm:pt-5 sm:pb-5">
    <!-- Title / subtitle -->
    <div class="space-y-1">
      <h3 class="text-base font-semibold text-white sm:text-lg">
        <a href={href} class="hover:text-roiBlue transition-colors">
          {title}
        </a>
      </h3>

      {subtitle && (
        <p class="text-xs text-slate-300/85 sm:text-sm">
          {subtitle}
        </p>
      )}
    </div>

    <!-- Spacer -->
    <div class="flex-1"></div>

    <!-- Price + status + CTA -->
    <div class="mt-4 space-y-3 border-t border-white/5 pt-4">
      <div class="flex flex-wrap items-center justify-between gap-2">
        <p class="text-sm font-medium text-slate-100 sm:text-base">
          {priceLabel}
        </p>

        {statusLabel && (
          <span
            class={`inline-flex items-center rounded-full px-2.5 py-1 text-[0.7rem] font-semibold uppercase tracking-[0.14em] ring-1 ${statusClasses}`}
          >
            {statusLabel}
          </span>
        )}
      </div>

      <a
        href={href}
        class="inline-flex w-full items-center justify-center gap-2 rounded-lg bg-primary/90 px-3 py-2 text-sm font-semibold text-primary-content shadow-[0_12px_30px_rgba(15,23,42,0.65)] transition-colors transition-shadow hover:bg-primary hover:shadow-[0_16px_40px_rgba(15,23,42,0.9)] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-roiBlue focus-visible:ring-offset-2 focus-visible:ring-offset-slate-950"
      >
        View details
        <span aria-hidden="true" class="text-xs opacity-80">
          â†’
        </span>
      </a>
    </div>
  </div>
</article>
