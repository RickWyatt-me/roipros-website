---
import Layout from '../layouts/Layout.astro';
import ProductCard from '../components/shop/ProductCard.astro';

const activeCategory = Astro.url.searchParams.get('category') ?? 'all';

const filters = [
  { label: 'All services', value: 'all' },
  { label: 'CNC Routing', value: 'cnc-routing' },
  { label: 'Rotary 4th Axis', value: 'rotary' },
  { label: 'Laser', value: 'laser' }
];

// Temporary “products” – later these can come from Shopify
const products = [
  {
    handle: 'precision-cnc-flatwork',
    title: 'Precision CNC Flatwork',
    subtitle: 'Sheet goods, hardwoods, templates, fixtures, and production panels.',
    badge: 'Made to order',
    badgeTone: 'default',
    category: 'cnc-routing',
    priceLabel: 'Quoted per project',
    statusLabel: 'In stock',
    statusTone: 'in-stock',
    href: '/quote',
    imageSrc: '/images/store/cnc-flatwork.jpg'
  },
  {
    handle: '4th-axis-rotary-machining',
    title: '4th Axis Rotary Machining',
    subtitle:
      'Up to 40" length and 4" diameter for multi-sided milling and complex 3D work.',
    badge: 'New',
    badgeTone: 'accent',
    category: 'rotary',
    priceLabel: 'Quoted per project',
    statusLabel: 'In stock',
    statusTone: 'in-stock',
    href: '/quote',
    imageSrc: '/images/store/rotary-axis.jpg'
  },
  {
    handle: '45w-laser-cutting-engraving',
    title: '45W Laser Cutting & Engraving',
    subtitle:
      'PLH3D-XT8 laser head, 45W optical power, 0.18mm spot for fine engraving and cutting.',
    badge: 'High detail',
    badgeTone: 'accent',
    category: 'laser',
    priceLabel: 'Quoted per project',
    statusLabel: 'In stock',
    statusTone: 'in-stock',
    href: '/quote',
    imageSrc: '/images/store/laser.jpg'
  },
  {
    handle: 'prototype-fixtures',
    title: 'Prototype Jigs & Fixtures',
    subtitle: 'Low-run production jigs, vacuum fixtures, and workholding solutions.',
    badge: 'Popular',
    badgeTone: 'default',
    category: 'cnc-routing',
    priceLabel: 'Starting at $325',
    statusLabel: 'Made to order',
    statusTone: 'made-to-order',
    href: '/quote',
    imageSrc: '/images/store/fixtures.jpg'
  },
  {
    handle: 'production-routing',
    title: 'Production Routing Runs',
    subtitle: 'Tight-tolerance production routing with ±0.002" accuracy and QC checks.',
    badge: 'For teams',
    badgeTone: 'default',
    category: 'cnc-routing',
    priceLabel: 'Volume-based pricing',
    statusLabel: 'In stock',
    statusTone: 'in-stock',
    href: '/quote',
    imageSrc: '/images/store/production.jpg'
  }
];

const filteredProducts =
  activeCategory === 'all'
    ? products
    : products.filter((p) => p.category === activeCategory);

const activeFilterLabel =
  filters.find((f) => f.value === activeCategory)?.label ?? 'All services';
---

<Layout title="ROlpros Store – CNC & laser services">
  <main class="bg-noise">
    <section class="mx-auto max-w-7xl px-6 pb-20 pt-10 sm:pt-16 sm:pb-24">
      <!-- Page eyebrow -->
      <p class="text-[0.72rem] font-semibold uppercase tracking-[0.2em] text-slate-300/80">
        ROIPROS STORE
      </p>

      <!-- Main heading -->
      <div class="mt-3 max-w-3xl">
        <h1 class="text-3xl font-bold tracking-tight text-white sm:text-4xl md:text-5xl">
          Shop precision CNC &amp; laser services
        </h1>
      </div>

      <!-- Lead copy -->
      <div class="mt-4 max-w-2xl space-y-2 text-sm text-slate-200/90 sm:text-base">
        <p>
          From flat panel work to 4-axis rotary machining and 45W laser cutting, you get
          production-grade parts with ±0.002" accuracy, clean edges, and clear communication
          from start to finish.
        </p>
        <p class="text-slate-300/80">
          Whether you&apos;re a builder, fabricator, sign shop, or product designer, ROIpros
          plugs into your workflow like a modern, on-demand manufacturing partner.
        </p>
      </div>

      <!-- Filter row + helper link -->
      <div class="mt-8 flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
        <!-- Filters -->
        <div class="inline-flex flex-wrap gap-2 rounded-full bg-black/10 px-1.5 py-1 ring-1 ring-white/10">
          {filters.map((filter) => {
            const isActive = filter.value === activeCategory;
            return (
              <a
                href={filter.value === 'all' ? '/store' : `/store?category=${filter.value}`}
                class={`inline-flex items-center rounded-full px-3 py-1.5 text-xs font-medium transition-colors ${
                  isActive
                    ? 'bg-white text-slate-950'
                    : 'text-slate-200/85 hover:bg-white/10 hover:text-white'
                }`}
              >
                {filter.label}
              </a>
            );
          })}
        </div>

        <p class="text-xs text-slate-300/85 sm:text-sm">
          Don’t see what you need?{' '}
          <a href="/quote" class="underline underline-offset-4 hover:text-white">
            Request a custom quote.
          </a>
        </p>
      </div>

      <!-- Active filter status -->
      <div class="mt-5 text-xs font-medium uppercase tracking-[0.16em] text-slate-400/85">
        Showing {filteredProducts.length} service offering
        {filteredProducts.length === 1 ? '' : 's'} · {activeFilterLabel}
      </div>

      <!-- Product grid -->
      <div class="mt-6 grid gap-6 sm:mt-8 sm:grid-cols-2 xl:grid-cols-3">
        {filteredProducts.map((product) => (
          <ProductCard
            title={product.title}
            subtitle={product.subtitle}
            badge={product.badge}
            badgeTone={product.badgeTone}
            priceLabel={product.priceLabel}
            statusLabel={product.statusLabel}
            statusTone={product.statusTone}
            href={product.href}
            imageSrc={product.imageSrc}
            imageAlt={product.title}
          />
        ))}
      </div>

      <!-- Subtle footer note -->
      <div class="mt-10 max-w-2xl text-xs text-slate-400/80 sm:text-[0.78rem]">
        <p>
          All services are currently quoted per project. When your Shopify backend is live,
          this storefront can be wired directly to live product data, inventory, and checkout
          while keeping the same ROIpros look and feel.
        </p>
      </div>
    </section>
  </main>
</Layout>
